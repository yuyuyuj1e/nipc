{% extends 'other_base.html' %}

{% block style %}

{% endblock %}

{% block other_content %}
    <div class="row">
        <div class="col-lg-9">
            <div class="card p-4" style="min-height: 80vh;">
                <div id="vul-info" class="card-body">
                    <h2 class="card-title text-center">{{ vul.name }}</h2>
                    <div id="infos" class="ax_default heading_12">
                        <img id="" class="img" src="/static/img/eye.png"/>
                        <span>{{ vul.clicknum }}&nbsp;&nbsp;</span>
                        <img id="" class="img" style="width: 13px;padding-top: 2px;" src="/static/img/time.png"/>
                        <span>{{ vul.updatetime|date:'Y-m-d' }}&nbsp;&nbsp;</span>

                    </div>
                    <div class="card-text">
                        <h6 class="text-center font-weight-bold">漏洞信息</h6>
                        <div class="row">
                            <div class="col-4 ">
                                <label class="font-weight-normal">漏洞编号： </label><span>{{ vul.id }}</span>
                            </div>
                            <div class="col-4">
                                <label class="font-weight-normal">CVE编号： </label><span>{{ vul.cve|default:"" }}</span>
                            </div>
                            <div class="col-4">
                                <label class="font-weight-normal">漏洞类型： </label><span>{% firstof vul.class vul.class_field.class_description "-" %}</span>
                            </div>
                            <div class="col-4">
                                <label class="font-weight-normal">漏洞来源： </label><a href="{{ vul.url }}">{{ vul.source|default:"-" }}</a>
                            </div>
                            <div class="col-4">
                                <label class="font-weight-normal">发布日期： </label><span>{{ vul.publishtime|date:'Y-m-d' }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-text">
                        <h6 class="text-center font-weight-bold">CVSS</h6>
                        <div class="row">
                            <div class="col-4">
                                CVSS值： <span>{{ vul.cvss_cve|default:"-" }}</span>
                            </div>
                            <div class="col-4">
                                严重级别： <span>{{ vul.get_level_display }}</span>
                            </div>
                            <div class="col-4">
                                利用范围： <span>{{ vul.a_v|default:"-" }}</span>
                            </div>
                            <div class="col-4">
                                攻击复杂度： <span>{{ vul.a_c|default:"-" }}</span>
                            </div>
                            <div class="col-4">
                                认证级别： <span>{{ vul.auth|default:"-" }}</span>
                            </div>
                        </div>
                    </div>
                    {% if vul.description %}
                        <div class="card-text">
                            <h6 class="text-center font-weight-bold">漏洞描述</h6>
                            <p class="">{{ vul.description }}</p>
                        </div>
                    {% endif %}
                    {% if vul.poc %}
                        <div class="card-text">
                            <h6>POC</h6>
                            <p class="">{{ vul.poc }}</p>
                        </div>
                    {% endif %}
                    {% if vul.affect %}
                        <div class="card-text">
                            <h6>影响的系统和软件</h6>
                            <p class="">{{ vul.affect }}</p>
                        </div>
                    {% endif %}
                    {% if vul.solution %}
                        <div class="card-text border-bottom-0">
                            <h6 class="text-center font-weight-bold">解决方案</h6>
                            <p class="">
                                {{ vul.solution }}
                            </p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
{#        <div class="col-3 d-none d-lg-block">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    <h5 class="card-title pb-1">热门漏洞</h5>#}
{#                    <ul class="list-group list-group-flush ">#}
{#                        {% for i, t, d in top_vul %}#}
{#                            <li class="list-group-item text-truncate"><a#}
{#                                    href="/vulnerability/{{ i }}">{{ t }}</a><br><span class="text-muted">{{ d|date:'Y-m-d' }}</span>#}
{#                            </li>#}
{#                        {% endfor %}#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
    </div>
{% endblock %}
