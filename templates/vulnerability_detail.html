{% extends 'other_base.html' %}

{% block css %}
    <style>
        .move {
            transition: all 0.3s ease-in-out; /* 设置过渡效果 */
        }

        .move:hover {
            transform: scale(1.1); /* 放大1.1倍 */
            {#box-shadow: 0px 0px 10px #ccc; /* 添加阴影效果 */#}
        }
    </style>
{% endblock %}

{% block other_content %}
    <div class="container">
        <!--上边界-->
        <div class="mt-lg-5"></div>

        <div class="row">
            <!--详情页-->
            <div class="col-lg-9">
                <div class="card">
                    <div class="card-header text-center">
                        <h2 class="mt-4"> {{ vul.name }} </h2>
                        <div id="infos" class="ax_default heading_12 float-right">
                            <img id="" class="img" src="/static/img/eye.png"/>
                            <span>{{ vul.clicknum }}&nbsp;&nbsp;</span>
                            <img id="" class="img" style="width: 13px;padding-top: 2px;" src="/static/img/time.png"/>
                            <span>{{ vul.updatetime|date:'Y-m-d' }}&nbsp;&nbsp;</span>
                        </div>
                    </div>

                    <div class="card-body">
                        <div class="row">
                            <!--漏洞信息-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">漏洞信息</h5>
                                        <div class="row">
                                            <div class="col-4 mt-3 text-center">
                                                <label class="font-weight-normal">漏洞编号： </label><span>{{ vul.id }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                <label class="font-weight-normal">CVE编号： </label><span>{{ vul.cve|default:"-" }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                <label class="font-weight-normal">漏洞类型： </label><span>{% firstof vul.class vul.class_field.class_description "-" %}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                <label class="font-weight-normal">漏洞来源： </label><a
                                                    href="{{ vul.url }}"
                                                    target="_blank">{{ vul.source|default:"-" }}</a>
                                            </div>
                                            <div class="col-4 mt-3  text-center">
                                                <label class="font-weight-normal">发布日期： </label><span>{{ vul.publishtime|date:'Y-m-d' }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--CVSS-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">CVSS</h5>
                                        <div class="row">
                                            <div class="col-4 mt-3 text-center">
                                                CVSS值： <span>{{ vul.cvss_cve|default:"-" }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                严重级别： <span>{{ vul.get_level_display }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                利用范围： <span>{{ vul.a_v|default:"-" }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                攻击复杂度： <span>{{ vul.a_c|default:"-" }}</span>
                                            </div>
                                            <div class="col-4 mt-3 text-center">
                                                认证级别： <span>{{ vul.auth|default:"-" }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--漏洞描述-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">漏洞描述</h5>
                                        <p class="mt-4 text-justify">{{ vul.description|default:"待更新..." }}</p>
                                    </div>
                                </div>
                            </div>
                            <!--poc-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">POC</h5>
                                        <p class="mt-4 text-justify">{{ vul.poc|default:"待更新..." }}</p>
                                    </div>
                                </div>
                            </div>
                            <!--影响软件和系统-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">影响的系统和软件</h5>
                                        <p class="mt-4 text-justify">{{ vul.affect|default:"待更新..." }}</p>
                                    </div>
                                </div>
                            </div>
                            <!--解决方案-->
                            <div class="col-md-12 move">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-weight: bold">解决方案</h5>
                                        <p class="mt-4 text-justify">{{ vul.solution|default:"待更新..." }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--侧边热门漏洞页-->
            <div class="col-3 d-none d-lg-block">
                <div class="card">
                    <div class="card-header">
                        <h5 class="text-center" style="font-weight: bold">热门漏洞</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush ">
                            {% for id, title, date in top_vul %}
                                {% if forloop.first %}
                                    <li class="list-group-item text-truncate">
                                        <a href="/vulnerability/{{ id }}">{{ title }}</a><br>
                                        <span class="text-muted">{{ date|date:'Y-m-d' }}</span>
                                    </li>
                                {% else %}
                                    <li class="list-group-item text-truncate border-top">
                                        <a href="/vulnerability/{{ id }}">{{ title }}</a><br>
                                        <span class="text-muted">{{ date|date:'Y-m-d' }}</span>
                                    </li>
                                {% endif %}

                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!--下边界-->
        <div class="mb-lg-5"></div>
    </div>
{% endblock %}
